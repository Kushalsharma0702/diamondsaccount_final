INFO:     Started server process [53187]
INFO:     Waiting for application startup.
2025-12-04 12:21:48,136 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-12-04 12:21:48,136 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-04 12:21:48,138 INFO sqlalchemy.engine.Engine select current_schema()
2025-12-04 12:21:48,138 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-04 12:21:48,140 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2025-12-04 12:21:48,140 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-04 12:21:48,141 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-04 12:21:48,143 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-12-04 12:21:48,143 INFO sqlalchemy.engine.Engine [generated in 0.00018s] ('admin_users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-12-04 12:21:48,145 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-12-04 12:21:48,145 INFO sqlalchemy.engine.Engine [cached since 0.001986s ago] ('clients', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-12-04 12:21:48,146 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-12-04 12:21:48,146 INFO sqlalchemy.engine.Engine [cached since 0.002443s ago] ('documents', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-12-04 12:21:48,146 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-12-04 12:21:48,146 INFO sqlalchemy.engine.Engine [cached since 0.002684s ago] ('payments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-12-04 12:21:48,146 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-12-04 12:21:48,146 INFO sqlalchemy.engine.Engine [cached since 0.002871s ago] ('audit_logs', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-12-04 12:21:48,146 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-12-04 12:21:48,146 INFO sqlalchemy.engine.Engine [cached since 0.003144s ago] ('cost_estimates', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-12-04 12:21:48,147 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-12-04 12:21:48,147 INFO sqlalchemy.engine.Engine [cached since 0.003426s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-12-04 12:21:48,147 INFO sqlalchemy.engine.Engine 
CREATE TABLE admin_users (
	id UUID NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	password_hash VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	permissions VARCHAR[] NOT NULL, 
	avatar VARCHAR(500), 
	is_active BOOLEAN NOT NULL, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	updated_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	last_login_at TIMESTAMP WITH TIME ZONE, 
	PRIMARY KEY (id)
)


2025-12-04 12:21:48,148 INFO sqlalchemy.engine.Engine [no key 0.00007s] ()
2025-12-04 12:21:48,154 INFO sqlalchemy.engine.Engine CREATE UNIQUE INDEX ix_admin_users_email ON admin_users (email)
2025-12-04 12:21:48,154 INFO sqlalchemy.engine.Engine [no key 0.00008s] ()
2025-12-04 12:21:48,155 INFO sqlalchemy.engine.Engine 
CREATE TABLE clients (
	id UUID NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	phone VARCHAR(20), 
	filing_year INTEGER NOT NULL, 
	status VARCHAR(50) NOT NULL, 
	payment_status VARCHAR(20) NOT NULL, 
	assigned_admin_id UUID, 
	total_amount FLOAT NOT NULL, 
	paid_amount FLOAT NOT NULL, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	updated_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(assigned_admin_id) REFERENCES admin_users (id)
)


2025-12-04 12:21:48,155 INFO sqlalchemy.engine.Engine [no key 0.00010s] ()
2025-12-04 12:21:48,157 INFO sqlalchemy.engine.Engine CREATE INDEX ix_clients_filing_year ON clients (filing_year)
2025-12-04 12:21:48,157 INFO sqlalchemy.engine.Engine [no key 0.00007s] ()
2025-12-04 12:21:48,157 INFO sqlalchemy.engine.Engine CREATE INDEX ix_clients_assigned_admin_id ON clients (assigned_admin_id)
2025-12-04 12:21:48,158 INFO sqlalchemy.engine.Engine [no key 0.00006s] ()
2025-12-04 12:21:48,158 INFO sqlalchemy.engine.Engine CREATE INDEX ix_clients_name ON clients (name)
2025-12-04 12:21:48,158 INFO sqlalchemy.engine.Engine [no key 0.00005s] ()
2025-12-04 12:21:48,158 INFO sqlalchemy.engine.Engine CREATE INDEX ix_clients_status ON clients (status)
2025-12-04 12:21:48,158 INFO sqlalchemy.engine.Engine [no key 0.00005s] ()
2025-12-04 12:21:48,159 INFO sqlalchemy.engine.Engine CREATE INDEX ix_clients_payment_status ON clients (payment_status)
2025-12-04 12:21:48,159 INFO sqlalchemy.engine.Engine [no key 0.00004s] ()
2025-12-04 12:21:48,159 INFO sqlalchemy.engine.Engine CREATE INDEX ix_clients_email ON clients (email)
2025-12-04 12:21:48,159 INFO sqlalchemy.engine.Engine [no key 0.00003s] ()
2025-12-04 12:21:48,160 INFO sqlalchemy.engine.Engine 
CREATE TABLE documents (
	id UUID NOT NULL, 
	client_id UUID NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	type VARCHAR(100) NOT NULL, 
	status VARCHAR(20) NOT NULL, 
	version INTEGER NOT NULL, 
	uploaded_at TIMESTAMP WITH TIME ZONE, 
	notes TEXT, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	updated_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(client_id) REFERENCES clients (id)
)


2025-12-04 12:21:48,160 INFO sqlalchemy.engine.Engine [no key 0.00005s] ()
2025-12-04 12:21:48,161 INFO sqlalchemy.engine.Engine CREATE INDEX ix_documents_status ON documents (status)
2025-12-04 12:21:48,161 INFO sqlalchemy.engine.Engine [no key 0.00004s] ()
2025-12-04 12:21:48,161 INFO sqlalchemy.engine.Engine CREATE INDEX ix_documents_client_id ON documents (client_id)
2025-12-04 12:21:48,161 INFO sqlalchemy.engine.Engine [no key 0.00004s] ()
2025-12-04 12:21:48,162 INFO sqlalchemy.engine.Engine 
CREATE TABLE payments (
	id UUID NOT NULL, 
	client_id UUID NOT NULL, 
	amount FLOAT NOT NULL, 
	method VARCHAR(50) NOT NULL, 
	note TEXT, 
	created_by_id UUID NOT NULL, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(client_id) REFERENCES clients (id), 
	FOREIGN KEY(created_by_id) REFERENCES admin_users (id)
)


2025-12-04 12:21:48,162 INFO sqlalchemy.engine.Engine [no key 0.00006s] ()
2025-12-04 12:21:48,163 INFO sqlalchemy.engine.Engine CREATE INDEX ix_payments_client_id ON payments (client_id)
2025-12-04 12:21:48,163 INFO sqlalchemy.engine.Engine [no key 0.00004s] ()
2025-12-04 12:21:48,163 INFO sqlalchemy.engine.Engine 
CREATE TABLE cost_estimates (
	id UUID NOT NULL, 
	client_id UUID NOT NULL, 
	service_cost FLOAT NOT NULL, 
	discount FLOAT NOT NULL, 
	gst_hst FLOAT NOT NULL, 
	total FLOAT NOT NULL, 
	status VARCHAR(50) NOT NULL, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	updated_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(client_id) REFERENCES clients (id)
)


2025-12-04 12:21:48,163 INFO sqlalchemy.engine.Engine [no key 0.00005s] ()
2025-12-04 12:21:48,164 INFO sqlalchemy.engine.Engine CREATE INDEX ix_cost_estimates_status ON cost_estimates (status)
2025-12-04 12:21:48,164 INFO sqlalchemy.engine.Engine [no key 0.00004s] ()
2025-12-04 12:21:48,164 INFO sqlalchemy.engine.Engine CREATE INDEX ix_cost_estimates_client_id ON cost_estimates (client_id)
2025-12-04 12:21:48,164 INFO sqlalchemy.engine.Engine [no key 0.00004s] ()
2025-12-04 12:21:48,165 INFO sqlalchemy.engine.Engine 
CREATE TABLE notes (
	id UUID NOT NULL, 
	client_id UUID NOT NULL, 
	content TEXT NOT NULL, 
	is_client_facing BOOLEAN NOT NULL, 
	author_id UUID NOT NULL, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now() NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(client_id) REFERENCES clients (id), 
	FOREIGN KEY(author_id) REFERENCES admin_users (id)
)


2025-12-04 12:21:48,165 INFO sqlalchemy.engine.Engine [no key 0.00004s] ()
2025-12-04 12:21:48,166 INFO sqlalchemy.engine.Engine CREATE INDEX ix_notes_client_id ON notes (client_id)
2025-12-04 12:21:48,166 INFO sqlalchemy.engine.Engine [no key 0.00004s] ()
2025-12-04 12:21:48,166 INFO sqlalchemy.engine.Engine COMMIT
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8002 (Press CTRL+C to quit)
INFO:     127.0.0.1:53082 - "GET /health HTTP/1.1" 200 OK
2025-12-04 17:00:10,944 INFO sqlalchemy.engine.Engine BEGIN (implicit)
sys:1: SAWarning: relationship 'AuditLog.performed_by_admin' will copy column admin_users.id to column audit_logs.performed_by_id, which conflicts with relationship(s): 'AdminUser.created_audit_logs' (copies admin_users.id to audit_logs.performed_by_id). If this is not the intention, consider if these relationships should be linked with back_populates, or if viewonly=True should be applied to one or more if they are read-only. For the less common case that foreign key constraints are partially overlapping, the orm.foreign() annotation can be used to isolate the columns that should be written towards.   To silence this warning, add the parameter 'overlaps="created_audit_logs"' to the 'AuditLog.performed_by_admin' relationship. (Background on this warning at: https://sqlalche.me/e/20/qzyx) (This warning originated from the `configure_mappers()` process, which was invoked automatically in response to a user-initiated operation.)
2025-12-04 17:00:10,971 INFO sqlalchemy.engine.Engine SELECT admin_users.id, admin_users.email, admin_users.name, admin_users.password_hash, admin_users.role, admin_users.permissions, admin_users.avatar, admin_users.is_active, admin_users.created_at, admin_users.updated_at, admin_users.last_login_at 
FROM admin_users 
WHERE admin_users.email = $1::VARCHAR
2025-12-04 17:00:10,971 INFO sqlalchemy.engine.Engine [generated in 0.00055s] ('superadmin@taxease.ca',)
2025-12-04 17:00:10,982 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:44710 - "POST /api/v1/auth/login HTTP/1.1" 401 Unauthorized
2025-12-04 17:01:16,860 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-04 17:01:16,861 INFO sqlalchemy.engine.Engine SELECT admin_users.id, admin_users.email, admin_users.name, admin_users.password_hash, admin_users.role, admin_users.permissions, admin_users.avatar, admin_users.is_active, admin_users.created_at, admin_users.updated_at, admin_users.last_login_at 
FROM admin_users 
WHERE admin_users.email = $1::VARCHAR
2025-12-04 17:01:16,861 INFO sqlalchemy.engine.Engine [cached since 65.89s ago] ('superadmin@taxease.ca',)
2025-12-04 17:01:16,862 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:45134 - "POST /api/v1/auth/login HTTP/1.1" 401 Unauthorized
2025-12-04 17:01:25,842 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-04 17:01:25,843 INFO sqlalchemy.engine.Engine SELECT admin_users.id, admin_users.email, admin_users.name, admin_users.password_hash, admin_users.role, admin_users.permissions, admin_users.avatar, admin_users.is_active, admin_users.created_at, admin_users.updated_at, admin_users.last_login_at 
FROM admin_users 
WHERE admin_users.email = $1::VARCHAR
2025-12-04 17:01:25,843 INFO sqlalchemy.engine.Engine [cached since 74.87s ago] ('superadmin@taxease.ca',)
2025-12-04 17:01:25,844 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:55714 - "POST /api/v1/auth/login HTTP/1.1" 401 Unauthorized
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [53187]
